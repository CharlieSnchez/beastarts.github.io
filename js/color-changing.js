var cH,cW,c=document.getElementById("c"),ctx=c.getContext("2d"),bgColor="#000000",animations=[],circles=[],isDrawing=!1,circleTransitionWorking=!1,isSelectable=!1,purpleColor="#7d45bc",yellowColor="#ffd012",lightGrayColor="#ebebeb",darkGrayColor="#2b2b2b",currentCircleColor=[darkGrayColor,darkGrayColor],ga=1,timerId=3,colorPicker=function(){var e=["#363636","#FFD012"],r=0;return{next:function o(){return e[r=r++<e.length-1?r:0]},current:function o(){return e[r]}}}(),currentColor=colorPicker.current(),nextColor=colorPicker.next();function removeAnimation(e){if(isDrawing){var r=animations.indexOf(e);r>-1&&animations.splice(r,1),enableNewScene(newScene),fadeOut()}}function calcPageFillRadius(e,r){return Math.sqrt(Math.pow(Math.max(e-0,cW-e),2)+Math.pow(Math.max(r-0,cH-r),2))}function addClickListeners(){document.addEventListener("touchend",handleEvent),document.addEventListener("mousedown",handleEvent),document.addEventListener("mouseout",function(e){var r=(e=e||window.event).relatedTarget||e.toElement;r&&"HTML"!=r.nodeName||(document.getElementById("outer-mouse").style.border="2px solid #ffffff00",document.getElementById("inner-mouse").style.backgroundColor="#ffffff00")}),document.addEventListener("mouseenter",function(e){bgColor==yellowColor||bgColor==lightGrayColor?(document.getElementById("outer-mouse").style.border="2px solid #000",document.getElementById("inner-mouse").style.backgroundColor="#000"):(document.getElementById("outer-mouse").style.border="2px solid #ffffff",document.getElementById("inner-mouse").style.backgroundColor="#ffffff")})}function handleEvent(e){circleTransitionWorking||isSelectable||setTimeout(function(){if(buttonTouch){e.touches&&(e.preventDefault(),e=e.touches[0]),circleTransitionWorking=!0;var r=calcPageFillRadius(e.pageX,e.pageY),o=Math.min(200,.4*cW);isDrawing=!0;var t=new Circle({x:e.pageX,y:e.pageY,r:0,fill:currentCircleColor});if("intro"==currentScene)var n=anime({targets:t,r:r,duration:Math.max(r/2,750),easing:"easeOutQuart",complete:function(){document.getElementById("touchAnywhere").style.opacity="50%",bgColor=t.fill,removeAnimation(n),isDrawing=!1,circleTransitionWorking=!1,isSelectable=!1}});else var n=anime({targets:t,r:r,duration:Math.max(r/2,750),direction:"reverse",easing:"easeOutQuart",complete:function(){bgColor=t.fill,removeAnimation(n),isDrawing=!1,circleTransitionWorking=!1,isSelectable=!1}});for(var i=new Circle({x:e.pageX,y:e.pageY,r:0,fill:currentColor,stroke:{width:3,color:currentColor},opacity:1}),l=anime({targets:i,r:o,opacity:0,easing:"easeOutExpo",duration:900,complete:removeAnimation}),a=[],u=0;u<32;u++){var s=new Circle({x:e.pageX,y:e.pageY,fill:nonCurrentCircleColor()[randomIntFromInterval(0,1)],r:anime.random(24/devicePixelRatio,48/devicePixelRatio)});a.push(s)}var d=anime({targets:a,x:function(e){return e.x+anime.random(o,-o)},y:function(e){return e.y+anime.random(1.15*o,-(1.15*o))},r:0,easing:"easeOutExpo",duration:anime.random(1e3,1300),complete:removeAnimation});animations.push(n,l,d)}},250)}function randomIntFromInterval(e,r){return Math.floor(Math.random()*(r-e+1)+e)}function nonCurrentCircleColor(){return currentCircleColor==yellowColor?[darkGrayColor,darkGrayColor]:currentCircleColor==lightGrayColor?[purpleColor,yellowColor]:currentCircleColor==purpleColor?[lightGrayColor,lightGrayColor]:[yellowColor,yellowColor]}function extend(e,r){for(var o in r)r.hasOwnProperty(o)&&(e[o]=r[o]);return e}var Circle=function(e){extend(this,e)};function animateCircle(){anyTransitionWorking&&!circleTransitionWorking&&(circleTransitionWorking=!0,anime({duration:1/0,update:function(){ctx.fillStyle=bgColor,"intro"!=currentScene&&ctx.fillRect(0,0,cW,cH),animations.forEach(function(e){e.animatables.forEach(function(e){e.target.draw()})})},complete:function(){circleTransitionWorking=!1,console.log("YEEE")}}))}Circle.prototype.draw=function(){isDrawing&&(ctx.globalAlpha=this.opacity||1),ctx.beginPath(),ctx.arc(this.x,this.y,this.r,0,2*Math.PI,!1),this.stroke&&(ctx.strokeStyle=this.stroke.color,ctx.lineWidth=this.stroke.width,ctx.stroke()),this.fill&&(ctx.fillStyle=this.fill,ctx.fill()),ctx.closePath()};var auxBorderValue=2,zoomIn=!0,borderZoomWorking=!1;function animateNonButtonParticles(){borderZoomWorking||anyTransitionWorking||recursiveNonButtonParticles()}function recursiveNonButtonParticles(){buttonTouch||(auxBorderValue<5&&zoomIn?(borderZoomWorking=!0,setTimeout(function(){auxBorderValue++,document.getElementById("outer-mouse").style.border=auxBorderValue+"px solid #FFF",recursiveNonButtonParticles()},50)):(5==auxBorderValue&&(zoomIn=!1),auxBorderValue>2&&setTimeout(function(){document.getElementById("outer-mouse").style.border=--auxBorderValue+"px solid #FFF",recursiveNonButtonParticles()},50),!(auxBorderValue<=2)||zoomIn||(auxBorderValue=2,zoomIn=!0,borderZoomWorking=!1))),buttonTouch&&(document.getElementById("outer-mouse").style.border="2px solid #000")}var resizeCanvas=function(){cW=window.innerWidth,cH=window.innerHeight,c.width=cW*devicePixelRatio,c.height=cH*devicePixelRatio,ctx.scale(devicePixelRatio,devicePixelRatio),console.log("resized"),ctx.globalAlpha=0};function handleInactiveUser(){var e=setTimeout(function(){},2e3);function r(){clearTimeout(e),document.removeEventListener("mousedown",r),document.removeEventListener("touchend",r)}document.addEventListener("mousedown",r),document.addEventListener("touchend",r)}function startFauxClicking(){setTimeout(function(){fauxClick(anime.random(.2*cW,.8*cW),anime.random(.2*cH,.8*cH)),startFauxClicking()},anime.random(200,900))}function fauxClick(e,r){fauxClick.pageX=e,fauxClick.pageY=r,document.dispatchEvent(fauxClick)}function fadeOut(){if(animations=[],ctx.clearRect(0,0,c.width,c.height),ctx.globalAlpha-=.01,"intro"==currentScene?ctx.fillStyle="#000000":ctx.fillStyle=currentCircleColor,ctx.fillRect(0,0,cW,cH),ctx.globalAlpha>.01){setTimeout(fadeOut,timerId);return}ctx.globalAlpha=0,document.getElementById("c").style.pointerEvents="none","intro"==currentScene&&(buttonTouch=!1),anyTransitionWorking=!1,circleTransitionWorking=!1}function clickOnSelectableObject(){isSelectable=!0,setTimeout(function(){isSelectable=!1},500)}function secondClickOnGrid(){isSelectable=!1}function makeSelectable(){isSelectable=!0}resizeCanvas(),window.CP&&(window.CP.PenTimer.MAX_TIME_IN_LOOP_WO_EXIT=6e3),window.addEventListener("resize",resizeCanvas),window.addEventListener("backbutton",function(e){"intro"!=currentScene&&document.getElementById(currentScene).click()}),addClickListeners(),window.location.pathname.match(/fullcpgrid/),handleInactiveUser();